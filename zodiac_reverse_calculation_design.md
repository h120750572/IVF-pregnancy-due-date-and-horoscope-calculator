# 星座倒推胚胎植入期間計算邏輯設計

## 功能概述

這個新功能允許用戶選擇想要的星座，系統會自動計算建議的胚胎植入時間範圍，讓媽媽可以在適當的時間進行胚胎植入，以增加生出該星座寶寶的機會。

## 星座日期範圍定義

根據西洋占星學的標準定義：

- 牡羊座 (Aries): 3月21日 - 4月19日
- 金牛座 (Taurus): 4月20日 - 5月20日
- 雙子座 (Gemini): 5月21日 - 6月20日
- 巨蟹座 (Cancer): 6月21日 - 7月22日
- 獅子座 (Leo): 7月23日 - 8月22日
- 處女座 (Virgo): 8月23日 - 9月22日
- 天秤座 (Libra): 9月23日 - 10月22日
- 天蠍座 (Scorpio): 10月23日 - 11月21日
- 射手座 (Sagittarius): 11月22日 - 12月21日
- 摩羯座 (Capricorn): 12月22日 - 1月19日
- 水瓶座 (Aquarius): 1月20日 - 2月18日
- 雙魚座 (Pisces): 2月19日 - 3月20日

## 計算邏輯

### 基本計算原理

1. 用戶選擇想要的星座
2. 系統計算該星座的出生日期範圍
3. 從出生日期範圍倒推280天（40週）得到LMP日期範圍
4. 從LMP日期範圍計算胚胎植入日期範圍

### 詳細計算步驟

#### 步驟1：確定目標出生日期範圍
- 根據選擇的星座，確定出生日期的開始和結束日期
- 考慮年份的選擇（當年或次年）

#### 步驟2：計算LMP日期範圍
- 出生日期開始 - 280天 = LMP開始日期
- 出生日期結束 - 280天 = LMP結束日期

#### 步驟3：計算胚胎植入日期範圍
根據不同的胚胎類型：

**新鮮胚胎植入（第3天）：**
- LMP + 17天 = 植入日期開始
- LMP + 17天 = 植入日期結束

**新鮮胚胎植入（第5天囊胚）：**
- LMP + 19天 = 植入日期開始
- LMP + 19天 = 植入日期結束

**冷凍胚胎植入（第3天）：**
- LMP + 17天 = 植入日期開始
- LMP + 17天 = 植入日期結束

**冷凍胚胎植入（第5天囊胚）：**
- LMP + 19天 = 植入日期開始
- LMP + 19天 = 植入日期結束

## 特殊考量

### 跨年星座處理
對於跨年的星座（如摩羯座：12月22日-1月19日），需要特別處理：
- 如果當前日期在12月，目標年份為次年
- 如果當前日期在1-11月，目標年份可以是當年或次年

### 植入時間的實際可行性
- 考慮醫療機構的作息時間
- 避開重大節假日
- 提供多個時間選項供選擇

### 成功率考量
- 提醒用戶這只是時間建議，不保證結果
- 強調醫療專業建議的重要性
- 說明影響懷孕的其他因素

## 用戶界面設計考量

### 星座選擇界面
- 提供12個星座的選項
- 顯示每個星座的日期範圍
- 包含星座圖示和特質描述

### 結果顯示
- 清楚顯示建議的植入時間範圍
- 提供不同胚胎類型的選項
- 包含重要提醒和免責聲明

### 互動功能
- 允許用戶調整年份
- 提供日曆視圖
- 支援多個星座比較

